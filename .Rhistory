wd = wd,
sameChrOnly = TRUE,
nCores = 8, filterTopReps = 0.001, maxTopHits = 1, kmerSize = 19, kmerStep = 19,
topNhits2keep = 1, maxBestMaps = 1, minMapq = 60,
overwrite = F,
MCScanX_hCall = pth2mcsh)
faf <- list.files(path = "/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/genomes/assembly", full.names = T)
names(faf) <- gsub("Sbicolor_|SbicolorPI_|_.*", "", basename(faf))
faf
names(faf) <- ifelse(names(faf) == "730", "BTx623", sprintf("PI", names(faf)))
faf <- list.files(path = "/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/genomes/assembly", full.names = T)
names(faf) <- gsub("Sbicolor_|SbicolorPI_|_.*", "", basename(faf))
names(faf) <- ifelse(names(faf) == "730", "BTx623", sprintf("PI%s", names(faf)))
faf
wd <- "/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs"
pth2mcsh <- "/Users/lovell/Desktop/programs/MCScanX/MCScanX_h"
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
kmerStep = 19,
topNhits2keep = 1,
maxBestMaps = 1,
minMapq = 60,
overwrite = F,
MCScanX_hCall = pth2mcsh)
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
nWindows = 500e6
windowSize = 200,
wd <- "/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs"
pth2mcsh <- "/Users/lovell/Desktop/programs/MCScanX/MCScanX_h"
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
nWindows = 500e6,
windowSize = 200,
kmerStep = 19,
topNhits2keep = 1,
maxBestMaps = 1,
minMapq = 60,
overwrite = F,
MCScanX_hCall = pth2mcsh)
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
nWindows = 500e3,
windowSize = 200,
kmerStep = 19,
topNhits2keep = 1,
maxBestMaps = 1,
minMapq = 60,
overwrite = F,
MCScanX_hCall = pth2mcsh)
test
roxygen2::roxygenise()
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
nWindows = 500e3,
windowSize = 200,
kmerStep = 19,
topNhits2keep = 1,
maxBestMaps = 1,
minMapq = 60,
overwrite = F,
ripHeightPerGenome = .5,
MCScanX_hCall = pth2mcsh)
paff <- list.files(path = wd, pattern = "syn.paf$", full.names = T)
paff
wd
list.files(path = wd)
paff <- list.files(path = wd, pattern = "syn.paf.gz$", full.names = T)
paff
dsRun
head(paff,1)
head(dsRun,1)
roxygen2::roxygenise()
dsRun <- run_deepspace(
faFiles = faf,
wd = wd,
sameChrOnly = TRUE,
nCores = 8,
filterTopReps = 0.01,
maxTopHits = 1,
kmerSize = 19,
nWindows = 500e3,
windowSize = 200,
kmerStep = 19,
topNhits2keep = 1,
maxBestMaps = 1,
minMapq = 60,
overwrite = F,
MCScanX_hCall = pth2mcsh)
dsRun
with(dsRun, riparian_default(
pafFiles = synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .075,
chrWidth = .05,
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .075,
chrWidth = .05,
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .25,
chrWidth = .2,
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
dev.off()
roxygen2::roxygenise()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .25,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
dev.off()
dev.off()
tmp2
roxygen2::roxygenise()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .25,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
dev.off()
chrdat
spl <- split(chrdat, by = "genome")
labelTheseGenomes <- "BTx623"
spl1 <- split(subset(chrdat, genome %in% labelTheseGenomes), by = "genome")
spl1
spln <- split(subset(chrdat, !genome %in% labelTheseGenomes), by = "genome")
spln
splg <- data.table(spln[[1]])
splg
with(splg, plot(x, y))
yr <- range(splg$y)
yr
scale_between()
scale_between
splg
with(splg, plot(x, scale_between(y, min = 10, max = 100)))
yadj <- diff(yr)/2
yadj
with(splg, plot(x, scale_between(y, min = yr[1] + yadj, max = yr[2] - yadj)))
yadj <- diff(yr)/4
with(splg, plot(x, scale_between(y, min = yr[1] + yadj, max = yr[2] - yadj)))
roxygen2::roxygenise()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .25,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .1,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .2,
braidAlpha = .5))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .1,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,braidOutlineWidth = .01,
braidAlpha = .5))
dev.off()
roxygen2::roxygenise()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .1,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,braidOutlineWidth = .05,
braidAlpha = .5))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2, labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_tall.pdf", height = 10, width = 8)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = TRUE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_wide.pdf", height = 10, width = 24)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = TRUE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_wideSameWidth.pdf", height = 10, width = 24)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = FALSE,
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_wideSameWidth.pdf", height = 10, width = 24)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = "white",
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_wideSameWidth.pdf", height = 10, width = 24)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = "green",
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
?quantile
round_toInteger
?round_toInteger
?round
?ape::compute.brlen
data(bird.orders)
bird.orders
plot(bird.orders)
tre <- read.tree("/Users/lovell/Desktop/active_projects/Mguttatus_4genomes/genespace_4genomes_23Apr2024/results/SpeciesTree_rooted.txt")
tre
plot(tre)
plot(compute.brlen(tre))
?plot_riparian
pdf("/Users/lovell/Desktop/active_projects/Sorghum_refGenomes/deepspace_sameChrs/test32_wideSameWidth.pdf", height = 10, width = 24)
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,
labelTheseGenomes = "BTx623",
highlightInversions = "green",
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
dev.off()
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = "grey",
labelTheseGenomes = "BTx623",
highlightInversions = "green",
howRound = .5,
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = "grey",
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = c("red", "blue"),
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = rainbow(10),
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = rainbow(10),
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1, chrOutlineColor = "black", chrOutlineWidth = .1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = FALSE,
braidOffset = .02,
chrWidth = .2,  braidColors = rainbow(10),
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1, chrOutlineColor = "black", chrOutlineWidth = 1,
braidAlpha = .75))
with(dsRun, riparian_default(
pafFiles = mapFilePaths$synFile,
refGenome = refGenome,
genomeIDs = genomeIDs,
sameChrOnly = sameChrOnly,
orderyBySynteny = TRUE,
sameScale = T,
braidOffset = .02,
chrWidth = .2,  braidColors = rainbow(10),
labelTheseGenomes = "BTx623",
highlightInversions = "green",
gapProp = .05,
braidOutlineWidth = .1, chrOutlineColor = "black", chrOutlineWidth = 1,
braidAlpha = .75))
rm(list = ls())
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
